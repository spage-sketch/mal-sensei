<!DOCTYPE html>
<html lang="hr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NITRO ANALYTICS V8 // GRAPHQL SPEEDSTER</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/luxon@3.4.4/build/global/luxon.min.js"></script>
    <style>
        :root{--bg:#050505;--card:#111;--text:#e0e0e0;--muted:#888;--accent:#00ff88;--blue:#00d9ff;--red:#ff0066;--gold:#ffd700;--line:#222;--shadow:rgba(0,255,136,0.4)}
        body{margin:0;padding:20px;background:var(--bg);color:var(--text);font-family:'Courier New',monospace;
            background-image:linear-gradient(rgba(0,255,136,.03)1px,transparent 1px),linear-gradient(90deg,rgba(0,255,136,.03)1px,transparent 1px);
            background-size:40px 40px;overflow-x:hidden;}
        .container{max-width:1400px;margin:auto;text-align:center;}
        h1{font-size:3.2rem;margin:30px 0;background:linear-gradient(90deg,var(--accent),var(--blue));
            -webkit-background-clip:text;-webkit-text-fill-color:transparent;text-shadow:0 0 30px var(--shadow);}
        #drop-zone{border:4px dashed var(--accent);padding:80px;border-radius:20px;background:rgba(0,255,136,.08);cursor:pointer;transition:.4s;margin:40px auto;max-width:600px;}
        #drop-zone:hover,#drop-zone.highlight{background:rgba(0,255,136,.2);box-shadow:0 0 60px var(--shadow);transform:scale(1.02);}
        #drop-zone h2{font-size:2.2rem;margin:0 0 15px 0;color:var(--accent);}
        #drop-zone p{color:var(--muted);margin:10px 0;}
        .hidden{display:none;}
        .dashboard{margin-top:40px;}
        
        .grid-kpi{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:15px;margin:40px 0;}
        .grid-full{display:grid;grid-template-columns:repeat(auto-fit,minmax(400px,1fr));gap:20px;margin:40px 0;}

        .card{background:var(--card);border:1px solid var(--line);border-radius:14px;padding:25px;box-shadow:0 10px 30px rgba(0,0,0,.7);text-align:left;position:relative;}
        .card-header{font-size:1.4rem;color:var(--blue);border-left:3px solid var(--accent);padding-left:10px;margin-bottom:15px;}
        .big-num{font-size:4rem;font-weight:bold;color:var(--accent);text-align:center;text-shadow:0 0 20px var(--shadow);}
        .label{color:var(--muted);text-transform:uppercase;font-size:1rem;margin-top:8px;text-align:center;}
        
        #personality-box{text-align:center;padding:20px;margin-bottom:30px;border:1px solid var(--accent);border-radius:14px;}
        #personality-title{font-size:2rem;color:var(--accent);margin:0;text-shadow:0 0 15px var(--shadow);}
        #personality-desc{font-style:italic;color:var(--muted);margin-top:10px;}

        .insight-item{padding:8px 0;border-bottom:1px dashed #333;}
        .insight-title{color:var(--red);font-weight:bold;}
        .insight-val{color:var(--text);margin-top:4px;font-size:1.1rem;}

        .btn-group{margin:50px 0;text-align:center;}
        .btn{background:var(--accent);color:#000;padding:12px 24px;border:none;border-radius:8px;cursor:pointer;font-weight:bold;font-size:1rem;margin:8px;transition:.3s;}
        .btn:hover{transform:scale(1.05);box-shadow:0 0 20px var(--accent);}
        .btn:disabled{background:#555;cursor:not-allowed;opacity:0.6;}
        .progress{width:100%;height:20px;background:#333;border-radius:10px;overflow:hidden;margin:10px 0;}
        .progress-bar{height:100%;background:var(--accent);width:0%;transition:width .6s;box-shadow:0 0 15px var(--accent);}
        #statusMsg{margin-top:20px;font-size:1.1rem;color:var(--accent);min-height:50px;}
        .error-msg{color:var(--red);background:rgba(255,0,102,.1);padding:15px;border-radius:8px;margin:20px 0;}
        .badge{background:var(--blue);color:var(--bg);padding:6px 12px;border-radius:6px;font-size:0.95rem;display:inline-block;margin:8px;font-weight:bold;}
        canvas { max-height: 300px; }
    </style>
</head>
<body>
<div class="container">
    <h1>NITRO ANALYTICS V8 // GRAPHQL SPEEDSTER</h1>
    <p style="color:#888;font-size:1rem;">AniList GraphQL Batch Processing – brže, stabilnije, jače</p>

    <div id="drop-zone">
        <h2>DROP MAL XML / CSV</h2>
        <p>ili klikni za odabir</p>
        <input type="file" id="fileInput" accept=".xml,.csv" style="display:none">
    </div>

    <div id="dashboard" class="dashboard hidden">
        
        <div id="personality-box">
            <div id="personality-title">Analiza u tijeku...</div>
            <div id="personality-desc">Učitavam tvoj anime arhetip.</div>
            <div id="personality-comment" style="margin-top:15px;font-size:1.4rem;color:#00ff88;">"..."</div>
        </div>

        <div class="grid-kpi">
            <div class="card"><div class="big-num" id="completed">0</div><div class="label">Završeno</div></div>
            <div class="card"><div class="big-num" id="mean">0.00</div><div class="label">Prosjek</div></div>
            <div class="card"><div class="big-num" id="eps">0</div><div class="label">Epizoda</div></div>
            <div class="card"><div class="big-num" id="days">0</div><div class="label">Dana gledanja</div></div>
            <div class="card"><div class="big-num" style="color:var(--gold)" id="tens">0</div><div class="label">10/10</div></div>
        </div>

        <div class="grid-full">
            <div class="card">
                <div class="card-header">STATUS DISTRIBUCIJA</div>
                <canvas id="statusChart"></canvas>
            </div>
            <div class="card">
                <div class="card-header">OCJENE vs ANILIST PROSJEK</div>
                <canvas id="vsChart"></canvas>
                <div id="vsError" style="text-align:center;color:var(--muted);margin-top:10px;">Pokreni Shadow Fetch za usporedbu</div>
            </div>
            <div class="card">
                <div class="card-header">ZAVRŠENO PO GODINAMA</div>
                <canvas id="timelineChart"></canvas>
            </div>
        </div>
        
        <div class="grid-full">
            <div class="card">
                <div class="card-header">DUBINSKA ANALIZA</div>
                <div class="insight-item"><div class="insight-title">Tvoj Arhetip:</div><div class="insight-val" id="insight-archetype">-</div></div>
                <div class="insight-item"><div class="insight-title">Najduži Maraton:</div><div class="insight-val" id="insight-marathon">-</div></div>
                <div class="insight-item"><div class="insight-title">Najkontroverznija 10/10:</div><div class="insight-val" id="insight-controversial">-</div></div>
                <div class="insight-item"><div class="insight-title">Najgori uradak (tvoja ocjena):</div><div class="insight-val" id="insight-gap">-</div></div>
            </div>

            <div class="card">
                <div class="card-header">TOP 10 ŽANROVA</div>
                <canvas id="genreChart"></canvas>
            </div>

            <div class="card">
                <div class="card-header">COSINE PREPORUKE</div>
                <div id="recsContent" style="min-height:120px;padding-top:10px;">Pokreni Shadow Fetch za preporuke!</div>
            </div>

            <div class="card">
                <div class="card-header">ACHIEVEMENTI</div>
                <div id="achievementsContent" style="text-align:center;min-height:120px;padding-top:10px;">Pokreni Shadow Fetch za badgeove!</div>
            </div>
        </div>

        <div class="btn-group">
            <button class="btn" id="shadowBtn">SHADOW FETCH (AniList)</button>
            <button class="btn" onclick="exportJSON()">EXPORT JSON</button>
            <button class="btn" onclick="generateInfographic()">INFOGRAFIKA</button>
            <button class="btn" onclick="location.reload()">NOVA ANALIZA</button>
        </div>

        <div id="statusMsg">Učitaj svoj MAL export da započnemo!</div>
    </div>
</div>

<script>
let data = [], enriched = [];
let statusChartInstance, vsChartInstance, timelineChartInstance, genreChartInstance;

// Drag & Drop
const dropZone = document.getElementById('drop-zone');
const fileInput = document.getElementById('fileInput');
dropZone.ondragover = e => { e.preventDefault(); dropZone.classList.add('highlight'); };
dropZone.ondragleave = e => { e.preventDefault(); dropZone.classList.remove('highlight'); };
dropZone.ondrop = e => { e.preventDefault(); dropZone.classList.remove('highlight'); processFile(e.dataTransfer.files[0]); };
dropZone.onclick = () => fileInput.click();
fileInput.onchange = e => { if(e.target.files[0]) processFile(e.target.files[0]); };

function processFile(file) {
    if (!file) return;
    setStatus(`Učitavam: ${file.name}...`, false);
    const reader = new FileReader();
    reader.onload = e => {
        try {
            if (file.name.endsWith('.xml')) parseXML(e.target.result);
            else Papa.parse(e.target.result, {header:true, skipEmptyLines:true, complete: r => { data = r.data.map(normalizeRow); go(); }});
        } catch (err) {
            setStatus(`Greška pri parsiranju: ${err.message}`, true);
            console.error(err);
        }
    };
    reader.readAsText(file);
}

function parseXML(text) {
    const xml = new DOMParser().parseFromString(text, 'text/xml');
    data = Array.from(xml.querySelectorAll('anime')).map(a => ({
        title: a.querySelector('series_title')?.textContent || 'Unknown',
        mal_id: parseInt(a.querySelector('series_animedb_id')?.textContent || 0) || null,
        score: parseInt(a.querySelector('my_score')?.textContent) || 0,
        status: normalizeStatus(a.querySelector('my_status')?.textContent || ''),
        watched: parseInt(a.querySelector('my_watched_episodes')?.textContent)||0,
        totalEp: parseInt(a.querySelector('series_episodes')?.textContent)||0,
        tags: (a.querySelector('my_tags')?.textContent||'').split(',').map(t=>t.trim()).filter(Boolean),
        year: parseInt((a.querySelector('my_finish_date')?.textContent || a.querySelector('my_start_date')?.textContent || '').slice(0,4)) || 0
    })).filter(a => a.mal_id);
    go();
}

function normalizeRow(r) {
    return {
        title: r.series_title || r.title || 'Unknown',
        mal_id: parseInt(r.series_animedb_id || r.mal_id || 0) || null,
        score: parseInt(r.my_score || r.score || 0),
        status: normalizeStatus(r.my_status || r.status || ''),
        watched: parseInt(r.my_watched_episodes || 0),
        totalEp: parseInt(r.series_episodes || 0),
        tags: (r.my_tags || r.tags || '').split(',').map(t=>t.trim()).filter(Boolean),
        year: parseInt(r.year || r.start_date?.slice(0,4) || 0) || 0
    };
}

function normalizeStatus(s) {
    if (!s) return 'Unknown';
    const str = s.toString().toLowerCase();
    if (str.includes('watch')) return 'Watching';
    if (str.includes('complete')) return 'Completed';
    if (str.includes('hold')) return 'On-Hold';
    if (str.includes('drop')) return 'Dropped';
    if (str.includes('plan')) return 'Plan to Watch';
    return 'Unknown';
}

function go() {
    enriched = data.map(a => ({...a, apiGenres: a.tags, malScore: null}));
    document.getElementById('drop-zone').classList.add('hidden');
    document.getElementById('dashboard').classList.remove('hidden');
    updateStats();
    renderCharts();
    determinePersonality();
    renderInsights();
    setStatus("GOTOVO! Pokreni <strong>SHADOW FETCH</strong> za AniList obogaćivanje.", false);
}

function updateStats() {
    const comp = data.filter(a => a.status === 'Completed').length;
    const scored = data.filter(a => a.score > 0);
    const mean = scored.length ? (scored.reduce((s,a) => s + a.score, 0) / scored.length).toFixed(2) : 0;
    const eps = data.reduce((s,a) => s + a.watched, 0);
    const days = Math.round(eps * 24 / 1440); // 24 min/ep

    document.getElementById('completed').textContent = comp;
    document.getElementById('mean').textContent = mean;
    document.getElementById('eps').textContent = eps;
    document.getElementById('days').textContent = days;
    document.getElementById('tens').textContent = data.filter(a => a.score === 10).length;
}

async function batchFetchAnimeData(malIds) {
    const queries = malIds.map((id, i) => `
        anime${i}: Media(idMal: ${id}, type: ANIME) {
            genres
            averageScore
        }
    `).join('\n');

    const res = await fetch('https://graphql.anilist.co', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ query: `query { ${queries} }` })
    });
    const json = await res.json();
    return json.data || {};
}

document.getElementById('shadowBtn').onclick = async () => {
    const btn = document.getElementById('shadowBtn');
    const malIds = enriched.filter(a => a.mal_id && !a.malScore).map(a => a.mal_id);
    if (!malIds.length) { setStatus("Svi naslovi već obogaćeni!", false); return; }

    btn.disabled = true;
    btn.textContent = 'Fetching...';
    setStatus('<div class="progress"><div class="progress-bar" id="bar"></div></div><div id="log">Počinjem Shadow Fetch...</div>', false);

    const batchSize = 20;
    let processed = 0;

    for (let i = 0; i < malIds.length; i += batchSize) {
        const batch = malIds.slice(i, i + batchSize);
        document.getElementById('log').textContent = `Batch ${i + 1}–${Math.min(i + batchSize, malIds.length)} od ${malIds.length}...`;
        const results = await batchFetchAnimeData(batch);

        Object.keys(results).forEach(key => {
            const anime = results[key];
            if (!anime) return;
            const malId = batch[parseInt(key.replace('anime', ''))];
            const item = enriched.find(a => a.mal_id === malId);
            if (item) {
                item.apiGenres = anime.genres || item.tags;
                item.malScore = anime.averageScore ? (anime.averageScore / 10).toFixed(2) : null;
            }
        });

        processed += batch.length;
        document.getElementById('bar').style.width = (processed / malIds.length * 100) + '%';
        if (i + batchSize < malIds.length) await new Promise(r => setTimeout(r, 600));
    }

    btn.disabled = false;
    btn.textContent = 'SHADOW FETCH (ZAVRŠENO)';
    setStatus(`SHADOW FETCH ZAVRŠEN! ${processed} naslova obogaćeno.`, false);
    renderCharts();
    renderInsights();
    renderRecommendations();
    renderAchievements();
};

function renderCharts() {
    renderStatusChart();
    renderTimelineChart();
    renderVsChart();
    renderGenreChart();
}

function renderStatusChart() {
    const counts = {};
    data.forEach(a => counts[a.status] = (counts[a.status] || 0) + 1);
    const ctx = document.getElementById('statusChart');
    if (statusChartInstance) statusChartInstance.destroy();
    statusChartInstance = new Chart(ctx, {
        type: 'doughnut',
        data: { labels: Object.keys(counts), datasets: [{ data: Object.values(counts), backgroundColor: ['#00ff88','#00d9ff','#ff0066','#ffd700','#ff8800'] }] },
        options: { plugins: { legend: { position: 'right', labels: { color: '#e0e0e0' } } } }
    });
}

function renderTimelineChart() {
    const years = {};
    enriched.forEach(a => { if (a.year > 0 && a.status === 'Completed') years[a.year] = (years[a.year] || 0) + 1; });
    const sorted = Object.entries(years).sort((a,b) => a[0] - b[0]);
    const ctx = document.getElementById('timelineChart');
    if (timelineChartInstance) timelineChartInstance.destroy();
    timelineChartInstance = new Chart(ctx, {
        type: 'line',
        data: { labels: sorted.map(x=>x[0]), datasets: [{ label: 'Završeno', data: sorted.map(x=>x[1]), borderColor: '#00d9ff', backgroundColor: 'rgba(0,217,255,0.2)', tension: 0.3, fill: true }] },
        options: { scales: { y: { beginAtZero: true, ticks: { color: '#e0e0e0' } }, x: { ticks: { color: '#e0e0e0' } } }, plugins: { legend: { labels: { color: '#e0e0e0' } } } }
    });
}

function renderVsChart() {
    const valid = enriched.filter(a => a.score > 0 && a.malScore);
    const el = document.getElementById('vsError');
    const ctx = document.getElementById('vsChart');

    if (vsChartInstance) vsChartInstance.destroy();

    if (valid.length < 5) {
        el.textContent = 'Nema dovoljno podataka (min. 5 ocjena s AniList prosjekom)';
        el.style.display = 'block';
        return;
    }

    el.style.display = 'none';
    const top15 = valid.slice(0, 15);
    vsChartInstance = new Chart(ctx, {
        type: 'bar',
        data: {
            labels: top15.map(a => a.title.length > 20 ? a.title.slice(0,17)+'...' : a.title),
            datasets: [
                { label: 'Tvoja ocjena', data: top15.map(a => a.score), backgroundColor: '#00ff88' },
                { label: 'AniList prosjek', data: top15.map(a => parseFloat(a.malScore)), backgroundColor: '#ff0066' }
            ]
        },
        options: { scales: { y: { min: 0, max: 10, ticks: { color: '#e0e0e0' } } }, plugins: { legend: { labels: { color: '#e0e0e0' } } } }
    });
}

function renderGenreChart() {
    const g = {};
    enriched.forEach(a => a.apiGenres.forEach(x => g[x] = (g[x] || 0) + 1));
    const top = Object.entries(g).sort((a,b) => b[1] - a[1]).slice(0, 10);
    const ctx = document.getElementById('genreChart');
    if (genreChartInstance) genreChartInstance.destroy();
    if (top.length === 0) {
        ctx.parentElement.innerHTML = '<p style="text-align:center;color:#888;padding:20px;">Nema žanrovskih podataka<br><small>Pokreni Shadow Fetch</small></p>';
        return;
    }
    genreChartInstance = new Chart(ctx, {
        type: 'doughnut',
        data: { labels: top.map(x=>x[0]), datasets: [{ data: top.map(x=>x[1]), backgroundColor: ['#00ff88','#00d9ff','#ff0066','#ffd700','#ff8800','#88ff00','#0088ff','#ff0088','#00ff00','#ffff00'] }] },
        options: { plugins: { legend: { position: 'right', labels: { color: '#e0e0e0' } } } }
    });
}

function determinePersonality() {
    const mean = parseFloat(document.getElementById('mean').textContent);
    const tens = parseInt(document.getElementById('tens').textContent);
    const completed = parseInt(document.getElementById('completed').textContent);

    let archetype = 'The Balanced Viewer';
    let desc = 'Uživaš u raznolikosti, ne pretjeruješ s ocjenama.';
    let quote = '„Imaš ukus. Miran, ali siguran.“';

    if (mean > 8.7) { archetype = 'The Generous God'; desc = 'Volis sve, život ti je anime.'; quote = '„Za tebe je sve 9+, legendo.“'; }
    else if (mean > 8.2) { archetype = 'The Soft Critic'; desc = 'Daješ visoke ocjene, ali ne pretjerano.'; quote = '„Volis anime. To je jasno.“'; }
    else if (mean < 6.5) { archetype = 'The Harsh Judge'; desc = 'Samo najbolje prolazi kod tebe.'; quote = '„Nije lako zadovoljiti te. Poštovanje.“'; }
    if (tens > 25) { archetype = 'The 10/10 Chad'; desc = 'Perfekcionist s velikim srcem.'; quote = '„Ti si razlog zašto autori plaču od sreće.“'; }
    if (completed > 300) { archetype = 'The Eternal Marathoner'; desc = 'Ti ne gledaš anime. Ti živiš u njemu.'; quote = '„Ti si hodajuća MAL statistika.“'; }

    document.getElementById('personality-title').textContent = archetype;
    document.getElementById('personality-desc').textContent = desc;
    document.getElementById('personality-comment').textContent = quote;
    document.getElementById('insight-archetype').textContent = `${archetype} — ${desc}`;
}

function renderInsights() {
    const scored = data.filter(a => a.score > 0);
    const longest = data.reduce((a,b) => (b.totalEp > a.totalEp ? b : a), data[0]);
    document.getElementById('insight-marathon').textContent = longest ? `${longest.title} (${longest.totalEp} ep)` : 'N/A';

    const tens = scored.filter(a => a.score === 10);
    const controversial = tens.length ? tens.sort((a,b) => (a.malScore || 10) - (b.malScore || 10))[0] : null;
    document.getElementById('insight-controversial').textContent = controversial ? `${controversial.title} (${controversial.malScore ? parseFloat(controversial.malScore).toFixed(1) : '?'} prosjek na AniListu)` : 'Nema 10/10';

    const worst = scored.length ? scored.reduce((a,b) => a.score < b.score ? a : b) : null;
    document.getElementById('insight-gap').textContent = worst ? `${worst.title} (${worst.score}/10)` : 'N/A';
}

function renderRecommendations() {
    const c = document.getElementById('recsContent');
    if (enriched.filter(a => a.apiGenres.length > 0 && a.score > 0).length < 10) {
        c.innerHTML = '<p style="color:#888;">Nema dovoljno obogaćenih podataka za preporuke.</p>';
        return;
    }
    // Jednostavna cosine preporuka
    const genres = [...new Set(enriched.flatMap(a => a.apiGenres))];
    const vectors = enriched.map(a => {
        const vec = genres.map(g => a.apiGenres.includes(g) ? (a.score || 5) : 0);
        return { title: a.title, score: a.score, vec };
    }).filter(v => v.score >= 8);

    const recs = [];
    vectors.forEach(v1 => {
        vectors.forEach(v2 => {
            if (v1.title === v2.title) return;
            const sim = cosineSimilarity(v1.vec, v2.vec);
            if (sim > 0.7) recs.push(`${v1.title} → ${v2.title} (sličnost: ${sim.toFixed(2)})`);
        });
    });

    const unique = [...new Set(recs)].slice(0, 8);
    c.innerHTML = unique.length ? unique.map(r => `<p class="insight-item">→ ${r}</p>`).join('') : '<p style="color:#888;">Nema jakih preporuka trenutno.</p>';
}

function renderAchievements() {
    const c = document.getElementById('achievementsContent');
    const completed = parseInt(document.getElementById('completed').textContent);
    const mean = parseFloat(document.getElementById('mean').textContent);
    const eps = parseInt(document.getElementById('eps').textContent);
    const tens = parseInt(document.getElementById('tens').textContent);
    const controversial = enriched.filter(a => a.score === 10 && a.malScore && parseFloat(a.malScore) < 7.5).length;

    const badges = [];
    if (completed >= 500) badges.push('Completionist Legend');
    else if (completed >= 250) badges.push('Veteran Watcher');
    else if (completed >= 100) badges.push('Dedicated Soul');
    
    if (mean > 8.5) badges.push('Generous Heart');
    if (mean < 6.5) badges.push('Elite Critic');
    if (tens > 20) badges.push('Masterpiece Hunter');
    if (eps > 10000) badges.push('Time Itself');
    if (controversial > 3) badges.push('Controversial King');

    c.innerHTML = badges.length ? badges.map(b => `<span class="badge">${b}</span>`).join('') : '<p style="color:#888;">Još nema značajnih achievementa.</p>';
}

function cosineSimilarity(a, b) {
    const dot = a.reduce((s, v, i) => s + v * b[i], 0);
    const magA = Math.sqrt(a.reduce((s, v) => s + v * v, 0));
    const magB = Math.sqrt(b.reduce((s, v) => s + v * v, 0));
    return magA && magB ? dot / (magA * magB) : 0;
}

function setStatus(html, isError = false) {
    const el = document.getElementById('statusMsg');
    el.innerHTML = isError ? `<div class="error-msg">${html}</div>` : html;
}

function exportJSON() {
    const a = document.createElement('a');
    a.href = URL.createObjectURL(new Blob([JSON.stringify(enriched, null, 2)], {type: 'application/json'}));
    a.download = 'nitro_v8_enriched.json';
    a.click();
}

function generateInfographic() {
    const stats = {
        completed: document.getElementById('completed').textContent,
        mean: document.getElementById('mean').textContent,
        eps: document.getElementById('eps').textContent,
        days: document.getElementById('days').textContent,
        tens: document.getElementById('tens').textContent,
        archetype: document.getElementById('personality-title').textContent
    };
    const html = `<!DOCTYPE html><html><head><style>body{background:#000;color:#0f0;font-family:monospace;text-align:center;padding:50px;}h1{font-size:4rem;}p{font-size:2rem;margin:20px;}</style></head><body>
        <h1>NITRO ANALYTICS V8</h1>
        <h2>${stats.archetype}</h2>
        <p>Završeno: <strong>${stats.completed}</strong></p>
        <p>Prosjek ocjena: <strong>${stats.mean}</strong></p>
        <p>Epizoda: <strong>${stats.eps}</strong> (≈ ${stats.days} dana)</p>
        <p>10/10 remek-djela: <strong>${stats.tens}</strong></p>
        <br><br>
        <p>Generated: ${new Date().toLocaleString('hr-HR')}</p>
    </body></html>`;
    const a = document.createElement('a');
    a.href = URL.createObjectURL(new Blob([html], {type: 'text/html'}));
    a.download = 'nitro_infographic.html';
    a.click();
}

// Inicijalno
renderCharts();
</script>
</body>
</html>
